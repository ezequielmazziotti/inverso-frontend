<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Inverso ‚Äî An√°lisis de activos con IA</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
<style>
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#0b0e13;--surface:#13171f;--surface2:#1a1f2b;--border:#1e2530;
  --accent:#c9a96e;--accent-dim:rgba(201,169,110,0.12);--accent-border:rgba(201,169,110,0.25);
  --text:#e8e4dc;--muted:#7a8394;--green:#4caf82;--red:#e05a5a;--yellow:#c9a96e;
  --white:#ffffff;
}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:'DM Sans',sans-serif;font-weight:300;line-height:1.6;overflow-x:hidden}

/* SCROLLBAR */
::-webkit-scrollbar{width:4px}
::-webkit-scrollbar-track{background:var(--bg)}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:2px}

/* LAYOUT */
.app{display:flex;min-height:100vh}
.sidebar{width:220px;background:var(--surface);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;top:0;left:0;height:100vh;z-index:50;transition:transform 0.3s}
.main{margin-left:220px;flex:1;min-height:100vh}

/* SIDEBAR */
.sidebar-logo{padding:1.75rem 1.5rem 1.25rem;border-bottom:1px solid var(--border)}
.logo-text{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:700;color:var(--accent)}
.logo-text span{color:var(--text)}
.logo-sub{font-size:0.7rem;color:var(--muted);letter-spacing:0.08em;text-transform:uppercase;margin-top:0.2rem}
.sidebar-nav{padding:1rem 0;flex:1}
.nav-section-label{font-size:0.65rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--muted);padding:0.5rem 1.5rem 0.3rem}
.nav-item{display:flex;align-items:center;gap:0.75rem;padding:0.65rem 1.5rem;cursor:pointer;color:var(--muted);font-size:0.875rem;transition:all 0.2s;border-left:2px solid transparent;text-decoration:none}
.nav-item:hover{color:var(--text);background:rgba(255,255,255,0.03)}
.nav-item.active{color:var(--accent);border-left-color:var(--accent);background:var(--accent-dim)}
.nav-icon{font-size:1rem;width:20px;text-align:center}
.sidebar-bottom{padding:1rem 1.5rem;border-top:1px solid var(--border)}
.plan-badge{background:var(--accent-dim);border:1px solid var(--accent-border);border-radius:6px;padding:0.5rem 0.75rem;text-align:center}
.plan-badge .plan-name{font-size:0.7rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--accent)}
.plan-badge .plan-analyses{font-size:0.75rem;color:var(--muted);margin-top:0.1rem}

/* TOPBAR */
.topbar{background:var(--surface);border-bottom:1px solid var(--border);padding:1rem 2rem;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:40}
.topbar-title{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:600}
.topbar-right{display:flex;align-items:center;gap:1rem}
.avatar{width:32px;height:32px;border-radius:50%;background:var(--accent-dim);border:1px solid var(--accent-border);display:flex;align-items:center;justify-content:center;font-size:0.8rem;color:var(--accent);cursor:pointer}

/* PAGES */
.page{display:none;padding:2rem}
.page.active{display:block}

/* SCREEN: DASHBOARD */
.search-hero{text-align:center;padding:3rem 1rem 2rem}
.search-hero h1{font-family:'Playfair Display',serif;font-size:2rem;margin-bottom:0.5rem}
.search-hero p{color:var(--muted);font-size:0.9rem;margin-bottom:2rem}
.search-box{position:relative;max-width:560px;margin:0 auto}
.search-input{width:100%;padding:1rem 1.25rem 1rem 3rem;background:var(--surface);border:1px solid var(--border);border-radius:10px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:1rem;outline:none;transition:border-color 0.2s}
.search-input:focus{border-color:var(--accent-border);box-shadow:0 0 0 3px var(--accent-dim)}
.search-input::placeholder{color:var(--muted)}
.search-icon{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:var(--muted);font-size:1.1rem}
.search-suggestions{position:absolute;top:100%;left:0;right:0;background:var(--surface2);border:1px solid var(--border);border-top:none;border-radius:0 0 10px 10px;z-index:100;display:none}
.search-suggestions.open{display:block}
.suggestion-item{padding:0.75rem 1.25rem;cursor:pointer;display:flex;align-items:center;justify-content:space-between;transition:background 0.15s}
.suggestion-item:hover{background:rgba(255,255,255,0.04)}
.sug-left{display:flex;flex-direction:column}
.sug-ticker{font-size:0.9rem;font-weight:500;color:var(--text)}
.sug-name{font-size:0.75rem;color:var(--muted)}
.sug-right{font-size:0.8rem;color:var(--green)}
.sug-right.neg{color:var(--red)}

.quick-label{font-size:0.7rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);text-align:center;margin:1.5rem 0 0.75rem}
.quick-chips{display:flex;flex-wrap:wrap;gap:0.5rem;justify-content:center;max-width:560px;margin:0 auto}
.chip{padding:0.4rem 0.9rem;background:var(--surface);border:1px solid var(--border);border-radius:100px;font-size:0.8rem;cursor:pointer;color:var(--muted);transition:all 0.2s}
.chip:hover{border-color:var(--accent-border);color:var(--accent)}

.market-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-top:2rem}
.market-card{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1.25rem}
.mc-label{font-size:0.7rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);margin-bottom:0.5rem}
.mc-value{font-family:'Playfair Display',serif;font-size:1.4rem;font-weight:600}
.mc-change{font-size:0.8rem;margin-top:0.2rem}
.mc-change.up{color:var(--green)}
.mc-change.down{color:var(--red)}

/* SCREEN: ANALYSIS */
.analysis-header{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem;display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem}
.ah-left{display:flex;flex-direction:column;gap:0.25rem}
.ah-ticker{font-family:'Playfair Display',serif;font-size:2rem;font-weight:700}
.ah-name{font-size:0.85rem;color:var(--muted)}
.ah-right{text-align:right}
.ah-price{font-family:'Playfair Display',serif;font-size:1.8rem}
.ah-change{font-size:0.9rem}
.ah-change.up{color:var(--green)}
.ah-change.down{color:var(--red)}

.analysis-grid{display:grid;grid-template-columns:1fr 2fr;gap:1.5rem;margin-bottom:1.5rem}
@media(max-width:700px){.analysis-grid{grid-template-columns:1fr}}

.score-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.75rem;display:flex;flex-direction:column;align-items:center;text-align:center;gap:1rem}
.score-ring{position:relative;width:120px;height:120px}
.score-ring svg{transform:rotate(-90deg)}
.score-ring circle{transition:stroke-dashoffset 1s ease}
.score-center{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);display:flex;flex-direction:column;align-items:center}
.score-num{font-family:'Playfair Display',serif;font-size:2.2rem;font-weight:700;color:var(--accent);line-height:1}
.score-den{font-size:0.7rem;color:var(--muted)}
.score-label-text{font-size:0.75rem;letter-spacing:0.08em;text-transform:uppercase;color:var(--muted)}
.score-desc{font-size:0.85rem;color:var(--muted);line-height:1.6}

.factors-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem}
.factors-title{font-size:0.75rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);margin-bottom:1rem}
.factor-item{display:flex;align-items:flex-start;gap:0.75rem;padding:0.85rem 0;border-bottom:1px solid var(--border)}
.factor-item:last-child{border-bottom:none;padding-bottom:0}
.factor-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0;margin-top:0.35rem}
.factor-dot.pos{background:var(--green)}
.factor-dot.neg{background:var(--red)}
.factor-dot.neu{background:var(--accent)}
.factor-body{}
.factor-name{font-size:0.82rem;font-weight:500;margin-bottom:0.2rem}
.factor-desc{font-size:0.78rem;color:var(--muted);line-height:1.5}

.mep-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}
.card-title{font-size:0.75rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);margin-bottom:1rem}
.mep-table{width:100%;border-collapse:collapse}
.mep-table th{font-size:0.75rem;letter-spacing:0.06em;text-transform:uppercase;color:var(--muted);padding:0.5rem 0.75rem;text-align:left;border-bottom:1px solid var(--border)}
.mep-table td{padding:0.65rem 0.75rem;font-size:0.875rem;border-bottom:1px solid rgba(30,37,48,0.5)}
.mep-table td:first-child{color:var(--muted);font-size:0.8rem}
.pos-val{color:var(--green)}
.neg-val{color:var(--red)}

.summary-card{background:var(--surface);border:1px solid var(--border);border-left:3px solid var(--accent);border-radius:0 12px 12px 0;padding:1.5rem;margin-bottom:1.5rem}

.btn{padding:0.7rem 1.5rem;border-radius:8px;border:none;cursor:pointer;font-family:'DM Sans',sans-serif;font-size:0.875rem;font-weight:500;transition:all 0.2s}
.btn-accent{background:var(--accent);color:#0b0e13}
.btn-accent:hover{background:#d9bc87}
.btn-outline{background:transparent;border:1px solid var(--border);color:var(--muted)}
.btn-outline:hover{border-color:var(--accent-border);color:var(--accent)}
.btn-locked{background:var(--surface2);border:1px solid var(--border);color:var(--muted)}
.btn-row{display:flex;gap:0.75rem;flex-wrap:wrap}

/* DEEP ANALYSIS */
.chart-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}
.chart-wrapper{height:240px;margin-top:1rem}

.projections-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:1rem;margin-bottom:1.5rem}
@media(max-width:600px){.projections-grid{grid-template-columns:1fr}}
.proj-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.25rem}
.proj-horizon{font-size:0.7rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--accent);margin-bottom:0.75rem}
.proj-scenario{display:flex;justify-content:space-between;align-items:center;padding:0.4rem 0;border-bottom:1px solid var(--border);font-size:0.82rem}
.proj-scenario:last-child{border-bottom:none}
.proj-scenario-label{color:var(--muted)}
.proj-scenario-val.up{color:var(--green)}
.proj-scenario-val.down{color:var(--red)}
.proj-scenario-val.neu{color:var(--accent)}

.peers-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}
.peer-item{display:flex;align-items:center;justify-content:space-between;padding:0.75rem 0;border-bottom:1px solid var(--border);font-size:0.875rem}
.peer-item:last-child{border-bottom:none}
.peer-ticker{font-weight:500}
.peer-name{font-size:0.75rem;color:var(--muted)}
.peer-perf.up{color:var(--green)}
.peer-perf.down{color:var(--red)}

.news-card{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}
.news-item{padding:0.85rem 0;border-bottom:1px solid var(--border)}
.news-item:last-child{border-bottom:none}
.news-source{font-size:0.7rem;letter-spacing:0.08em;text-transform:uppercase;color:var(--accent);margin-bottom:0.25rem}
.news-title{font-size:0.875rem;font-weight:500;margin-bottom:0.25rem}
.news-summary{font-size:0.78rem;color:var(--muted);line-height:1.5}
.news-date{font-size:0.7rem;color:var(--muted);margin-top:0.25rem}

/* SIMULATOR */
.sim-section{background:var(--surface);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-bottom:1.5rem}
.sim-row{display:flex;gap:1rem;flex-wrap:wrap;margin-bottom:1rem}
.form-group{display:flex;flex-direction:column;gap:0.4rem;flex:1;min-width:160px}
.form-label{font-size:0.75rem;letter-spacing:0.08em;text-transform:uppercase;color:var(--muted)}
.form-input{padding:0.65rem 0.9rem;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:0.9rem;outline:none;transition:border-color 0.2s}
.form-input:focus{border-color:var(--accent-border)}
.form-select{padding:0.65rem 0.9rem;background:var(--bg);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'DM Sans',sans-serif;font-size:0.9rem;outline:none;cursor:pointer}

.allocation-list{display:flex;flex-direction:column;gap:0.75rem;margin-bottom:1rem}
.allocation-item{display:flex;align-items:center;gap:1rem;background:var(--bg);border:1px solid var(--border);border-radius:8px;padding:0.75rem 1rem}
.alloc-ticker{font-weight:500;font-size:0.9rem;width:60px}
.alloc-slider{flex:1;accent-color:var(--accent)}
.alloc-pct{width:40px;text-align:right;font-size:0.85rem;color:var(--accent)}
.alloc-remove{color:var(--muted);cursor:pointer;font-size:1.1rem;transition:color 0.2s}
.alloc-remove:hover{color:var(--red)}

.sim-results{background:var(--bg);border:1px solid var(--border);border-radius:12px;padding:1.5rem;margin-top:1.5rem}
.sim-result-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:1rem;margin-bottom:1.5rem}
.sim-result-item{text-align:center}
.sri-label{font-size:0.7rem;letter-spacing:0.08em;text-transform:uppercase;color:var(--muted);margin-bottom:0.3rem}
.sri-value{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:600}
.sri-value.up{color:var(--green)}
.sri-value.down{color:var(--red)}

/* DYNAMIC SIM */
.ops-table{width:100%;border-collapse:collapse;margin-bottom:1rem}
.ops-table th{font-size:0.72rem;letter-spacing:0.06em;text-transform:uppercase;color:var(--muted);padding:0.5rem 0.75rem;text-align:left;border-bottom:1px solid var(--border)}
.ops-table td{padding:0.6rem 0.75rem;font-size:0.85rem;border-bottom:1px solid rgba(30,37,48,0.5)}
.ops-table td select,.ops-table td input{background:var(--bg);border:1px solid var(--border);color:var(--text);padding:0.35rem 0.5rem;border-radius:6px;font-family:'DM Sans',sans-serif;font-size:0.82rem;outline:none;width:100%}
.ops-table .remove-op{color:var(--muted);cursor:pointer;font-size:1rem}
.ops-table .remove-op:hover{color:var(--red)}

/* HISTORIAL */
.history-list{display:flex;flex-direction:column;gap:0.75rem}
.history-item{background:var(--surface);border:1px solid var(--border);border-radius:10px;padding:1.25rem;display:flex;align-items:center;justify-content:space-between;cursor:pointer;transition:border-color 0.2s}
.history-item:hover{border-color:var(--accent-border)}
.hi-left{display:flex;align-items:center;gap:1rem}
.hi-ticker{font-family:'Playfair Display',serif;font-size:1.25rem;font-weight:600}
.hi-meta{display:flex;flex-direction:column;gap:0.1rem}
.hi-name{font-size:0.8rem;color:var(--muted)}
.hi-date{font-size:0.72rem;color:var(--muted)}
.hi-right{display:flex;align-items:center;gap:1rem}
.hi-score{background:var(--accent-dim);border:1px solid var(--accent-border);border-radius:6px;padding:0.3rem 0.6rem;font-size:0.8rem;color:var(--accent)}
.hi-alert{background:rgba(224,90,90,0.1);border:1px solid rgba(224,90,90,0.25);border-radius:6px;padding:0.3rem 0.6rem;font-size:0.75rem;color:var(--red)}

/* LOADING */
.loading-screen{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:60vh;gap:1.5rem}
.loading-spinner{width:48px;height:48px;border:2px solid var(--border);border-top-color:var(--accent);border-radius:50%;animation:spin 0.8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-steps{display:flex;flex-direction:column;gap:0.5rem;text-align:center}
.loading-step{font-size:0.85rem;color:var(--muted);opacity:0;transition:opacity 0.4s}
.loading-step.visible{opacity:1}
.loading-step.done{color:var(--green)}

/* MODAL */
.modal-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(4px);z-index:200;display:none;align-items:center;justify-content:center;padding:1rem}
.modal-overlay.open{display:flex}
.modal{background:var(--surface);border:1px solid var(--border);border-radius:16px;padding:2rem;max-width:600px;width:100%;max-height:90vh;overflow-y:auto}
.modal-title{font-family:'Playfair Display',serif;font-size:1.4rem;margin-bottom:0.5rem}
.modal-sub{font-size:0.875rem;color:var(--muted);margin-bottom:1.75rem}
.plans-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:0.75rem;margin-bottom:1.5rem}
@media(max-width:500px){.plans-grid{grid-template-columns:1fr}}
.plan-card{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:1.25rem;text-align:center;transition:border-color 0.2s}
.plan-card.featured{border-color:var(--accent)}
.plan-card-name{font-size:0.7rem;letter-spacing:0.1em;text-transform:uppercase;color:var(--muted);margin-bottom:0.4rem}
.plan-card-price{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:700;margin-bottom:0.1rem}
.plan-card-price span{font-size:0.75rem;font-family:'DM Sans',sans-serif;color:var(--muted)}
.plan-card-features{text-align:left;margin-top:0.75rem;display:flex;flex-direction:column;gap:0.35rem}
.pcf{font-size:0.75rem;color:var(--muted);display:flex;align-items:flex-start;gap:0.4rem}
.pcf::before{content:'‚úì';color:var(--green);flex-shrink:0}
.pcf.locked::before{content:'‚úó';color:var(--border)}
.pcf.locked{opacity:0.5}

/* TABS */
.tabs{display:flex;gap:0;border-bottom:1px solid var(--border);margin-bottom:1.5rem}
.tab{padding:0.65rem 1.25rem;font-size:0.85rem;cursor:pointer;color:var(--muted);border-bottom:2px solid transparent;margin-bottom:-1px;transition:all 0.2s}
.tab:hover{color:var(--text)}
.tab.active{color:var(--accent);border-bottom-color:var(--accent)}

/* UTILS */
.section-label{font-size:0.7rem;letter-spacing:0.12em;text-transform:uppercase;color:var(--accent);margin-bottom:0.5rem}
.page-header{margin-bottom:1.75rem}
.page-header h1{font-family:'Playfair Display',serif;font-size:1.6rem}
.page-header p{color:var(--muted);font-size:0.875rem;margin-top:0.25rem}
.empty-state{text-align:center;padding:4rem 2rem;color:var(--muted)}
.empty-state .empty-icon{font-size:3rem;margin-bottom:1rem;opacity:0.4}
.empty-state p{font-size:0.9rem}

/* NOTIFICATIONS */
.toast{position:fixed;bottom:2rem;right:2rem;background:var(--surface2);border:1px solid var(--border);border-radius:10px;padding:0.85rem 1.25rem;font-size:0.875rem;z-index:300;transform:translateY(100px);opacity:0;transition:all 0.3s}
.toast.show{transform:translateY(0);opacity:1}
.toast.success{border-color:rgba(76,175,130,0.4);color:var(--green)}

@media(max-width:768px){
  .sidebar{transform:translateX(-100%)}
  .sidebar.open{transform:translateX(0)}
  .main{margin-left:0}
  .topbar{padding:1rem}
  .page{padding:1rem}
  .analysis-grid{grid-template-columns:1fr}
}
</style>
</head>
<body>

<!-- SIDEBAR -->
<aside class="sidebar" id="sidebar">
  <div class="sidebar-logo">
    <div class="logo-text">Inver<span>so</span></div>
    <div class="logo-sub">An√°lisis con IA</div>
  </div>
  <nav class="sidebar-nav">
    <div class="nav-section-label">Principal</div>
    <a class="nav-item active" onclick="showPage('dashboard')" id="nav-dashboard">
      <span class="nav-icon">‚¨õ</span> Dashboard
    </a>
    <a class="nav-item" onclick="showPage('historial')" id="nav-historial">
      <span class="nav-icon">üïê</span> Historial
    </a>
    <div class="nav-section-label" style="margin-top:0.75rem">Herramientas</div>
    <a class="nav-item" onclick="showPage('simulador')" id="nav-simulador">
      <span class="nav-icon">üìä</span> Simulador
      <span style="margin-left:auto;font-size:0.6rem;background:var(--accent-dim);border:1px solid var(--accent-border);color:var(--accent);padding:0.1rem 0.4rem;border-radius:4px">PRO</span>
    </a>
    <div class="nav-section-label" style="margin-top:0.75rem">Cuenta</div>
    <a class="nav-item" onclick="showUpgradeModal()">
      <span class="nav-icon">‚ö°</span> Actualizar plan
    </a>
  </nav>
  <div class="sidebar-bottom">
    <div class="plan-badge">
      <div class="plan-name">Plan Free</div>
      <div class="plan-analyses">2 de 3 an√°lisis usados</div>
    </div>
  </div>
</aside>

<!-- MAIN -->
<div class="main">

  <!-- TOPBAR -->
  <header class="topbar">
    <div style="display:flex;align-items:center;gap:1rem">
      <button onclick="toggleSidebar()" style="background:none;border:none;color:var(--muted);cursor:pointer;font-size:1.2rem;display:none" id="menu-btn">‚ò∞</button>
      <span class="topbar-title" id="topbar-title">Dashboard</span>
    </div>
    <div class="topbar-right">
      <div class="avatar">EZ</div>
    </div>
  </header>

  <!-- PAGE: DASHBOARD -->
  <div class="page active" id="page-dashboard">
    <div class="search-hero">
      <p class="section-label">Mercado argentino</p>
      <h1>¬øQu√© activo quer√©s <em style="font-style:italic;color:var(--accent)">analizar?</em></h1>
      <p>Ingres√° un ticker o nombre de activo y obten√© un an√°lisis completo con IA</p>
      <div class="search-box">
        <span class="search-icon">üîç</span>
        <input class="search-input" id="searchInput" placeholder="Ej: GGAL, AL30, YPF, d√≥lar MEP..." autocomplete="off" oninput="handleSearch(this.value)" onkeydown="if(event.key==='Enter')runAnalysis()"/>
        <div class="search-suggestions" id="suggestions"></div>
      </div>
      <div class="quick-label">M√°s consultados hoy</div>
      <div class="quick-chips">
        <div class="chip" onclick="selectAsset('GGAL')">GGAL</div>
        <div class="chip" onclick="selectAsset('YPF')">YPF</div>
        <div class="chip" onclick="selectAsset('AL30')">AL30</div>
        <div class="chip" onclick="selectAsset('GD30')">GD30</div>
        <div class="chip" onclick="selectAsset('PAMP')">PAMP</div>
        <div class="chip" onclick="selectAsset('MEP')">D√≥lar MEP</div>
        <div class="chip" onclick="selectAsset('MELI')">MELI CEDEAR</div>
      </div>
    </div>

    <div class="market-grid">
      <div class="market-card">
        <div class="mc-label">Merval</div>
        <div class="mc-value">2.184.320</div>
        <div class="mc-change up">‚Üë +2.4% hoy</div>
      </div>
      <div class="market-card">
        <div class="mc-label">D√≥lar MEP</div>
        <div class="mc-value">$1.247</div>
        <div class="mc-change up">‚Üë +0.3% hoy</div>
      </div>
      <div class="market-card">
        <div class="mc-label">Riesgo Pa√≠s</div>
        <div class="mc-value">612</div>
        <div class="mc-change down">‚Üì -18 puntos</div>
      </div>
      <div class="market-card">
        <div class="mc-label">Inflaci√≥n mensual</div>
        <div class="mc-value">2.4%</div>
        <div class="mc-change up">M√≠nimo desde 2021</div>
      </div>
    </div>
  </div>

  <!-- PAGE: LOADING -->
  <div class="page" id="page-loading">
    <div class="loading-screen">
      <div class="loading-spinner"></div>
      <div class="loading-steps">
        <div class="loading-step" id="ls1">Obteniendo datos hist√≥ricos del activo...</div>
        <div class="loading-step" id="ls2">Analizando contexto macroecon√≥mico...</div>
        <div class="loading-step" id="ls3">Consultando tipo de cambio y riesgo pa√≠s...</div>
        <div class="loading-step" id="ls4">Procesando an√°lisis con IA...</div>
        <div class="loading-step" id="ls5">Generando reporte...</div>
      </div>
    </div>
  </div>

  <!-- PAGE: AN√ÅLISIS B√ÅSICO -->
  <div class="page" id="page-analysis">
    <div class="page-header">
      <div style="display:flex;align-items:center;gap:0.75rem;margin-bottom:0.5rem">
        <button class="btn btn-outline" style="padding:0.4rem 0.85rem;font-size:0.8rem" onclick="showPage('dashboard')">‚Üê Volver</button>
        <span class="section-label" style="margin:0">An√°lisis b√°sico</span>
      </div>
    </div>

    <div class="analysis-header">
      <div class="ah-left">
        <div class="ah-ticker" id="an-ticker">GGAL</div>
        <div class="ah-name" id="an-name">Grupo Financiero Galicia ¬∑ Merval</div>
      </div>
      <div class="ah-right">
        <div class="ah-price" id="an-price">$6.842</div>
        <div class="ah-change up" id="an-change">‚Üë +4.2% hoy</div>
      </div>
    </div>

    <div class="analysis-grid">
      <div class="score-card">
        <p class="score-label-text">Score de oportunidad</p>
        <div class="score-ring">
          <svg width="120" height="120" viewBox="0 0 120 120">
            <circle cx="60" cy="60" r="52" fill="none" stroke="#1e2530" stroke-width="8"/>
            <circle id="scoreCircle" cx="60" cy="60" r="52" fill="none" stroke="#c9a96e" stroke-width="8"
              stroke-linecap="round" stroke-dasharray="326.7" stroke-dashoffset="98"/>
          </svg>
          <div class="score-center">
            <div class="score-num" id="an-score">7.2</div>
            <div class="score-den">/10</div>
          </div>
        </div>
        <p class="score-desc" id="an-score-desc">Perfil moderado-favorable. Fundamentos s√≥lidos en contexto de normalizaci√≥n macroecon√≥mica.</p>
      </div>

      <div class="factors-card">
        <div class="factors-title">Factores clave</div>
        <div id="factors-list">
          <div class="factor-item">
            <div class="factor-dot pos"></div>
            <div class="factor-body">
              <div class="factor-name">Contexto macro favorable</div>
              <div class="factor-desc">Estabilizaci√≥n cambiaria y baja del riesgo pa√≠s favorecen al sector financiero en el corto plazo.</div>
            </div>
          </div>
          <div class="factor-item">
            <div class="factor-dot pos"></div>
            <div class="factor-body">
              <div class="factor-name">Tendencia hist√≥rica alcista</div>
              <div class="factor-desc">Recuperaci√≥n sostenida desde m√≠nimos de 2022 con soportes bien definidos.</div>
            </div>
          </div>
          <div class="factor-item">
            <div class="factor-dot neg"></div>
            <div class="factor-body">
              <div class="factor-name">Riesgo pol√≠tico 2025</div>
              <div class="factor-desc">Elecciones legislativas pueden generar volatilidad. Exposici√≥n a deuda soberana a monitorear.</div>
            </div>
          </div>
          <div class="factor-item">
            <div class="factor-dot neu"></div>
            <div class="factor-body">
              <div class="factor-name">Tipo de cambio estable</div>
              <div class="factor-desc">Brecha cambiaria en niveles bajos. D√≥lar MEP estable reduce presi√≥n sobre activos dolarizados.</div>
            </div>
          </div>
          <div class="factor-item">
            <div class="factor-dot pos"></div>
            <div class="factor-body">
              <div class="factor-name">Liquidez del activo</div>
              <div class="factor-desc">Alta liquidez en el Merval. Spread bid-ask reducido facilita entrada y salida de posiciones.</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="mep-card">
      <div class="card-title">Comparaci√≥n con D√≥lar MEP</div>
      <table class="mep-table">
        <thead>
          <tr>
            <th>Per√≠odo</th>
            <th id="an-ticker-col">GGAL</th>
            <th>D√≥lar MEP</th>
            <th>Diferencia</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>30 d√≠as</td>
            <td class="pos-val">+18.4%</td>
            <td>+1.2%</td>
            <td class="pos-val">+17.2%</td>
          </tr>
          <tr>
            <td>90 d√≠as</td>
            <td class="pos-val">+41.2%</td>
            <td>+3.8%</td>
            <td class="pos-val">+37.4%</td>
          </tr>
          <tr>
            <td>365 d√≠as</td>
            <td class="pos-val">+182.6%</td>
            <td>+14.1%</td>
            <td class="pos-val">+168.5%</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="summary-card">
      <div class="card-title" style="margin-bottom:0.75rem">S√≠ntesis</div>
      <p id="an-summary" style="font-size:0.9rem;color:var(--muted);line-height:1.7">
        GGAL opera en un entorno m√°s favorable que en los √∫ltimos dos a√±os, impulsado por la desinflaci√≥n gradual y la reapertura del cr√©dito privado. La acci√≥n ha mostrado una recuperaci√≥n consistente y los fundamentos del sector bancario argentino siguen mejorando. Sin embargo, el riesgo electoral de 2025 y la sensibilidad a los bonos soberanos requieren monitoreo activo. Para perfiles moderados, representa una posici√≥n de acumulaci√≥n gradual con stops definidos. <strong style="color:var(--text)">Horizonte sugerido: 6-12 meses.</strong>
      </p>
    </div>

    <div class="btn-row">
      <button class="btn btn-accent" onclick="showDeepAnalysis()">Ver an√°lisis profundo ‚ö°</button>
      <button class="btn btn-outline" onclick="saveToHistory()">Guardar en historial</button>
      <button class="btn btn-outline" onclick="showPage('dashboard')">Nuevo an√°lisis</button>
    </div>
  </div>

  <!-- PAGE: AN√ÅLISIS PROFUNDO -->
  <div class="page" id="page-deep">
    <div class="page-header">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:1rem">
        <div style="display:flex;align-items:center;gap:0.75rem">
          <button class="btn btn-outline" style="padding:0.4rem 0.85rem;font-size:0.8rem" onclick="showPage('analysis')">‚Üê B√°sico</button>
          <span class="section-label" style="margin:0">An√°lisis profundo</span>
        </div>
        <button class="btn btn-accent" onclick="exportPDF()">Exportar PDF ‚Üì</button>
      </div>
    </div>

    <div class="analysis-header">
      <div class="ah-left">
        <div class="ah-ticker">GGAL</div>
        <div class="ah-name">Grupo Financiero Galicia ¬∑ Merval</div>
      </div>
      <div class="ah-right">
        <div class="ah-price">$6.842</div>
        <div class="ah-change up">‚Üë +4.2% hoy</div>
      </div>
    </div>

    <div class="chart-card">
      <div class="card-title">Evoluci√≥n hist√≥rica ‚Äî √∫ltimos 12 meses</div>
      <div class="chart-wrapper">
        <canvas id="priceChart"></canvas>
      </div>
    </div>

    <div class="projections-grid">
      <div class="proj-card">
        <div class="proj-horizon">3 meses</div>
        <div class="proj-scenario"><span class="proj-scenario-label">Optimista</span><span class="proj-scenario-val up">+35%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Neutro</span><span class="proj-scenario-val neu">+12%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Pesimista</span><span class="proj-scenario-val down">-8%</span></div>
      </div>
      <div class="proj-card">
        <div class="proj-horizon">6 meses</div>
        <div class="proj-scenario"><span class="proj-scenario-label">Optimista</span><span class="proj-scenario-val up">+68%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Neutro</span><span class="proj-scenario-val neu">+28%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Pesimista</span><span class="proj-scenario-val down">-15%</span></div>
      </div>
      <div class="proj-card">
        <div class="proj-horizon">12 meses</div>
        <div class="proj-scenario"><span class="proj-scenario-label">Optimista</span><span class="proj-scenario-val up">+140%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Neutro</span><span class="proj-scenario-val neu">+55%</span></div>
        <div class="proj-scenario"><span class="proj-scenario-label">Pesimista</span><span class="proj-scenario-val down">-22%</span></div>
      </div>
    </div>

    <div class="peers-card">
      <div class="card-title">Comparaci√≥n con activos similares (√∫ltimos 90 d√≠as)</div>
      <div class="peer-item">
        <div><div class="peer-ticker">GGAL</div><div class="peer-name">Galicia ¬∑ Actual</div></div>
        <div class="peer-perf up">+41.2%</div>
      </div>
      <div class="peer-item">
        <div><div class="peer-ticker">BMA</div><div class="peer-name">Banco Macro</div></div>
        <div class="peer-perf up">+38.7%</div>
      </div>
      <div class="peer-item">
        <div><div class="peer-ticker">SUPV</div><div class="peer-name">Supervielle</div></div>
        <div class="peer-perf up">+22.1%</div>
      </div>
    </div>

    <div class="news-card">
      <div class="card-title">Noticias recientes vinculadas al activo</div>
      <div class="news-item">
        <div class="news-source">El Cronista ¬∑ Hace 4 horas</div>
        <div class="news-title">Galicia lanza nueva l√≠nea de cr√©ditos hipotecarios UVA con tasas competitivas</div>
        <div class="news-summary">Impacto positivo: ampl√≠a cartera de cr√©dito en contexto de recuperaci√≥n del mercado inmobiliario. Podr√≠a impulsar ingresos netos en Q2.</div>
      </div>
      <div class="news-item">
        <div class="news-source">√Åmbito Financiero ¬∑ Hace 1 d√≠a</div>
        <div class="news-title">Riesgo pa√≠s rompe m√≠nimos desde 2019: qu√© significa para los bancos</div>
        <div class="news-summary">Impacto positivo: la ca√≠da del riesgo pa√≠s reduce el costo de fondeo y mejora el valor de los activos soberanos en cartera de los bancos.</div>
      </div>
      <div class="news-item">
        <div class="news-source">Infobae ¬∑ Hace 2 d√≠as</div>
        <div class="news-title">FMI aprueba nueva revisi√≥n del programa argentino: desembolso de USD 800 millones</div>
        <div class="news-summary">Impacto neutro-positivo: refuerza la estabilidad macro general pero el efecto directo sobre Galicia es indirecto v√≠a mejora del contexto sist√©mico.</div>
      </div>
    </div>

    <div class="summary-card">
      <div class="card-title" style="margin-bottom:0.75rem">S√≠ntesis profunda</div>
      <p style="font-size:0.9rem;color:var(--muted);line-height:1.7">
        GGAL mantiene su posici√≥n de liderazgo en el sector bancario argentino con catalizadores claros para los pr√≥ximos 12 meses: expansi√≥n del cr√©dito hipotecario, mejora del contexto macro y reducci√≥n del riesgo sist√©mico. La proyecci√≥n neutro-optimista apunta a retornos superiores al 50% en el horizonte anual, con el principal riesgo siendo la volatilidad pre-electoral y la exposici√≥n indirecta a bonos soberanos. Para inversores con tolerancia al riesgo moderada-alta, GGAL representa una de las mejores exposiciones al rebote argentino con liquidez diaria.
      </p>
    </div>

    <div class="btn-row">
      <button class="btn btn-accent" onclick="exportPDF()">Exportar PDF</button>
      <button class="btn btn-outline" onclick="saveToHistory()">Guardar en historial</button>
      <button class="btn btn-outline" onclick="showPage('dashboard')">Nuevo an√°lisis</button>
    </div>
  </div>

  <!-- PAGE: SIMULADOR -->
  <div class="page" id="page-simulador">
    <div class="page-header">
      <p class="section-label">Herramientas Pro</p>
      <h1>Simulador de cartera</h1>
      <p>Simul√° carteras de inversi√≥n con datos hist√≥ricos reales del mercado argentino</p>
    </div>

    <div class="tabs">
      <div class="tab active" onclick="switchSimTab('fixed',this)">Cartera fija</div>
      <div class="tab" onclick="switchSimTab('dynamic',this)">Cartera din√°mica</div>
    </div>

    <!-- CARTERA FIJA -->
    <div id="sim-fixed">
      <div class="sim-section">
        <div class="section-label">Configuraci√≥n</div>
        <div class="sim-row">
          <div class="form-group">
            <label class="form-label">Monto inicial</label>
            <input class="form-input" type="number" id="sim-amount" value="100000" placeholder="Ej: 100000"/>
          </div>
          <div class="form-group">
            <label class="form-label">Moneda</label>
            <select class="form-select" id="sim-currency">
              <option value="ars">Pesos argentinos (ARS)</option>
              <option value="usd">D√≥lares (USD)</option>
            </select>
          </div>
          <div class="form-group">
            <label class="form-label">Fecha de inicio</label>
            <input class="form-input" type="date" id="sim-date" value="2024-01-01"/>
          </div>
        </div>

        <div class="section-label" style="margin-top:1rem">Composici√≥n de la cartera</div>
        <div class="allocation-list" id="allocation-list">
          <div class="allocation-item">
            <span class="alloc-ticker">GGAL</span>
            <input type="range" class="alloc-slider" min="0" max="100" value="40" oninput="updateAlloc(this)"/>
            <span class="alloc-pct">40%</span>
            <span class="alloc-remove" onclick="removeAlloc(this)">‚úï</span>
          </div>
          <div class="allocation-item">
            <span class="alloc-ticker">AL30</span>
            <input type="range" class="alloc-slider" min="0" max="100" value="35" oninput="updateAlloc(this)"/>
            <span class="alloc-pct">35%</span>
            <span class="alloc-remove" onclick="removeAlloc(this)">‚úï</span>
          </div>
          <div class="allocation-item">
            <span class="alloc-ticker">MEP</span>
            <input type="range" class="alloc-slider" min="0" max="100" value="25" oninput="updateAlloc(this)"/>
            <span class="alloc-pct">25%</span>
            <span class="alloc-remove" onclick="removeAlloc(this)">‚úï</span>
          </div>
        </div>
        <div style="display:flex;gap:0.75rem;margin-top:0.75rem;flex-wrap:wrap">
          <button class="btn btn-outline" style="font-size:0.8rem" onclick="addAsset()">+ Agregar activo</button>
          <button class="btn btn-accent" onclick="runSimulation()">Simular cartera ‚Üí</button>
        </div>
      </div>

      <div class="sim-results" id="sim-results" style="display:none">
        <div class="section-label">Resultado de la simulaci√≥n</div>
        <div class="sim-result-grid">
          <div class="sim-result-item">
            <div class="sri-label">Inversi√≥n inicial</div>
            <div class="sri-value" style="color:var(--text)">$100.000</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">Valor actual</div>
            <div class="sri-value up">$318.240</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">Rendimiento total</div>
            <div class="sri-value up">+218.2%</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">vs Inflaci√≥n</div>
            <div class="sri-value up">+94.1%</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">vs D√≥lar MEP</div>
            <div class="sri-value up">+198.4%</div>
          </div>
        </div>
        <div class="chart-wrapper" style="height:220px">
          <canvas id="simChart"></canvas>
        </div>
      </div>
    </div>

    <!-- CARTERA DIN√ÅMICA -->
    <div id="sim-dynamic" style="display:none">
      <div class="sim-section">
        <div class="section-label">Registrar operaciones</div>
        <div style="overflow-x:auto">
          <table class="ops-table" id="ops-table">
            <thead>
              <tr>
                <th>Tipo</th>
                <th>Activo</th>
                <th>Cantidad</th>
                <th>Precio unitario</th>
                <th>Fecha</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="ops-body">
              <tr>
                <td><select><option>Compra</option><option>Venta</option></select></td>
                <td><input type="text" value="GGAL" placeholder="Ticker"/></td>
                <td><input type="number" value="100" placeholder="Cantidad"/></td>
                <td><input type="number" value="5800" placeholder="Precio"/></td>
                <td><input type="date" value="2024-03-15"/></td>
                <td><span class="remove-op" onclick="removeOp(this)">‚úï</span></td>
              </tr>
              <tr>
                <td><select><option>Compra</option><option>Venta</option></select></td>
                <td><input type="text" value="AL30" placeholder="Ticker"/></td>
                <td><input type="number" value="500" placeholder="Cantidad"/></td>
                <td><input type="number" value="48.5" placeholder="Precio"/></td>
                <td><input type="date" value="2024-06-01"/></td>
                <td><span class="remove-op" onclick="removeOp(this)">‚úï</span></td>
              </tr>
            </tbody>
          </table>
        </div>
        <div style="display:flex;gap:0.75rem;margin-top:0.75rem">
          <button class="btn btn-outline" style="font-size:0.8rem" onclick="addOp()">+ Agregar operaci√≥n</button>
          <button class="btn btn-accent" onclick="runDynamic()">Calcular resultado ‚Üí</button>
        </div>
      </div>

      <div class="sim-results" id="dyn-results" style="display:none">
        <div class="section-label">Cartera actual</div>
        <div class="sim-result-grid">
          <div class="sim-result-item">
            <div class="sri-label">Capital invertido</div>
            <div class="sri-value" style="color:var(--text)">$604.250</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">Valuaci√≥n actual</div>
            <div class="sri-value up">$1.024.800</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">Resultado</div>
            <div class="sri-value up">+$420.550</div>
          </div>
          <div class="sim-result-item">
            <div class="sri-label">Rendimiento</div>
            <div class="sri-value up">+69.6%</div>
          </div>
        </div>
        <div style="margin-top:1.25rem">
          <div class="section-label">Composici√≥n actual</div>
          <div class="peer-item"><div><div class="peer-ticker">GGAL (100)</div><div class="peer-name">Comprado a $5.800</div></div><div class="peer-perf up">+18.0% ¬∑ Val: $684.200</div></div>
          <div class="peer-item"><div><div class="peer-ticker">AL30 (500)</div><div class="peer-name">Comprado a $48.50</div></div><div class="peer-perf up">+41.2% ¬∑ Val: $340.600</div></div>
        </div>
      </div>
    </div>
  </div>

  <!-- PAGE: HISTORIAL -->
  <div class="page" id="page-historial">
    <div class="page-header">
      <p class="section-label">Tus an√°lisis</p>
      <h1>Historial</h1>
      <p>Revis√° y actualiz√° tus an√°lisis anteriores</p>
    </div>
    <div class="history-list" id="history-list">
      <div class="history-item" onclick="showPage('analysis')">
        <div class="hi-left">
          <div class="hi-ticker">GGAL</div>
          <div class="hi-meta">
            <div class="hi-name">Grupo Financiero Galicia</div>
            <div class="hi-date">Hoy, 14:32 ¬∑ An√°lisis b√°sico</div>
          </div>
        </div>
        <div class="hi-right">
          <div class="hi-score">Score 7.2</div>
          <div class="hi-alert">+12% desde el an√°lisis</div>
        </div>
      </div>
      <div class="history-item" onclick="showPage('deep')">
        <div class="hi-left">
          <div class="hi-ticker">AL30</div>
          <div class="hi-meta">
            <div class="hi-name">Bono Soberano Argentina 2030</div>
            <div class="hi-date">Ayer, 10:15 ¬∑ An√°lisis profundo</div>
          </div>
        </div>
        <div class="hi-right">
          <div class="hi-score">Score 6.8</div>
        </div>
      </div>
      <div class="history-item">
        <div class="hi-left">
          <div class="hi-ticker">YPF</div>
          <div class="hi-meta">
            <div class="hi-name">YPF S.A.</div>
            <div class="hi-date">Hace 3 d√≠as ¬∑ An√°lisis b√°sico</div>
          </div>
        </div>
        <div class="hi-right">
          <div class="hi-score">Score 8.1</div>
        </div>
      </div>
    </div>
  </div>

</div><!-- end main -->

<!-- MODAL UPGRADE -->
<div class="modal-overlay" id="upgradeModal">
  <div class="modal">
    <div class="modal-title">Actualiz√° tu plan</div>
    <div class="modal-sub">Esta funci√≥n est√° disponible en los planes Basic y Pro. Eleg√≠ el que mejor se adapta a lo que necesit√°s.</div>
    <div class="plans-grid">
      <div class="plan-card">
        <div class="plan-card-name">Free</div>
        <div class="plan-card-price">$0<span>/mes</span></div>
        <div class="plan-card-features">
          <div class="pcf">3 an√°lisis b√°sicos por mes</div>
          <div class="pcf locked">Sin historial</div>
          <div class="pcf locked">Sin simulador</div>
          <div class="pcf locked">Sin PDF</div>
        </div>
      </div>
      <div class="plan-card">
        <div class="plan-card-name">Basic</div>
        <div class="plan-card-price">$7.99<span>/mes</span></div>
        <div class="plan-card-features">
          <div class="pcf">An√°lisis ilimitados</div>
          <div class="pcf">Historial guardado</div>
          <div class="pcf locked">Sin simulador</div>
          <div class="pcf locked">Sin PDF</div>
        </div>
        <button class="btn btn-outline" style="width:100%;margin-top:1rem;font-size:0.8rem">Elegir Basic</button>
      </div>
      <div class="plan-card featured">
        <div class="plan-card-name">Pro</div>
        <div class="plan-card-price">$17.99<span>/mes</span></div>
        <div class="plan-card-features">
          <div class="pcf">Todo lo de Basic</div>
          <div class="pcf">An√°lisis profundo</div>
          <div class="pcf">Simulador de cartera</div>
          <div class="pcf">Exportaci√≥n PDF</div>
        </div>
        <button class="btn btn-accent" style="width:100%;margin-top:1rem;font-size:0.8rem">Elegir Pro ‚ö°</button>
      </div>
    </div>
    <button class="btn btn-outline" style="width:100%;font-size:0.85rem" onclick="closeModal()">Continuar con Free</button>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// DATA
const ASSETS = {
  'GGAL': {name:'Grupo Financiero Galicia ¬∑ Merval', price:'$6.842', change:'+4.2%', up:true, score:7.2},
  'YPF': {name:'YPF S.A. ¬∑ Merval', price:'$1.247', change:'+1.8%', up:true, score:8.1},
  'PAMP': {name:'Pampa Energ√≠a ¬∑ Merval', price:'$3.120', change:'+2.1%', up:true, score:7.8},
  'AL30': {name:'Bono Soberano Argentina 2030', price:'$52.40', change:'+3.4%', up:true, score:6.8},
  'GD30': {name:'Bono Global Argentina 2030', price:'$63.80', change:'-1.2%', up:false, score:6.5},
  'MEP': {name:'D√≥lar MEP ¬∑ Burs√°til', price:'$1.247', change:'+0.3%', up:true, score:5.2},
  'MELI': {name:'MercadoLibre ¬∑ CEDEAR', price:'$28.450', change:'+0.9%', up:true, score:7.5},
};

const SUGGESTIONS = [
  {ticker:'GGAL', name:'Grupo Financiero Galicia', change:'+4.2%', up:true},
  {ticker:'YPF', name:'YPF S.A.', change:'+1.8%', up:true},
  {ticker:'AL30', name:'Bono Soberano 2030', change:'+3.4%', up:true},
  {ticker:'GD30', name:'Bono Global 2030', change:'-1.2%', up:false},
  {ticker:'PAMP', name:'Pampa Energ√≠a', change:'+2.1%', up:true},
  {ticker:'MEP', name:'D√≥lar MEP', change:'+0.3%', up:true},
  {ticker:'MELI', name:'MercadoLibre CEDEAR', change:'+0.9%', up:true},
];

let currentAsset = 'GGAL';
let priceChartInstance = null;
let simChartInstance = null;

// NAVIGATION
function showPage(page) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
  const navEl = document.getElementById('nav-' + page);
  if(navEl) navEl.classList.add('active');
  const titles = {dashboard:'Dashboard', analysis:'An√°lisis', deep:'An√°lisis profundo', simulador:'Simulador', historial:'Historial', loading:'Analizando...'};
  document.getElementById('topbar-title').textContent = titles[page] || 'Inverso';
  if(page === 'deep') initPriceChart();
  window.scrollTo(0,0);
}

// SEARCH
function handleSearch(val) {
  const box = document.getElementById('suggestions');
  if(!val || val.length < 1) { box.classList.remove('open'); return; }
  const filtered = SUGGESTIONS.filter(a =>
    a.ticker.toLowerCase().includes(val.toLowerCase()) ||
    a.name.toLowerCase().includes(val.toLowerCase())
  );
  if(!filtered.length) { box.classList.remove('open'); return; }
  box.innerHTML = filtered.map(a => `
    <div class="suggestion-item" onclick="selectAsset('${a.ticker}')">
      <div class="sug-left">
        <span class="sug-ticker">${a.ticker}</span>
        <span class="sug-name">${a.name}</span>
      </div>
      <span class="sug-right ${a.up?'':'neg'}">${a.up?'‚Üë':'‚Üì'} ${a.change}</span>
    </div>
  `).join('');
  box.classList.add('open');
}

function selectAsset(ticker) {
  document.getElementById('searchInput').value = ticker;
  document.getElementById('suggestions').classList.remove('open');
  currentAsset = ticker;
  runAnalysis();
}

function runAnalysis() {
  const input = document.getElementById('searchInput').value.trim().toUpperCase();
  if(!input) return;
  currentAsset = ASSETS[input] ? input : 'GGAL';
  showPage('loading');
  startLoadingSequence();
}

function startLoadingSequence() {
  const steps = ['ls1','ls2','ls3','ls4','ls5'];
  steps.forEach(s => { document.getElementById(s).classList.remove('visible','done'); });
  let i = 0;
  const interval = setInterval(() => {
    if(i < steps.length) {
      if(i > 0) document.getElementById(steps[i-1]).classList.add('done');
      document.getElementById(steps[i]).classList.add('visible');
      i++;
    } else {
      clearInterval(interval);
      setTimeout(() => {
        populateAnalysis(currentAsset);
        showPage('analysis');
      }, 400);
    }
  }, 600);
}

function populateAnalysis(ticker) {
  const asset = ASSETS[ticker] || ASSETS['GGAL'];
  document.getElementById('an-ticker').textContent = ticker;
  document.getElementById('an-ticker-col').textContent = ticker;
  document.getElementById('an-name').textContent = asset.name;
  document.getElementById('an-price').textContent = asset.price;
  document.getElementById('an-change').textContent = (asset.up ? '‚Üë +' : '‚Üì ') + asset.change + ' hoy';
  document.getElementById('an-change').className = 'ah-change ' + (asset.up ? 'up' : 'down');
  document.getElementById('an-score').textContent = asset.score;
  const pct = asset.score / 10;
  const circ = 326.7;
  document.getElementById('scoreCircle').style.strokeDashoffset = circ * (1 - pct);
}

// DEEP ANALYSIS
function showDeepAnalysis() {
  showPage('deep');
}

function initPriceChart() {
  const ctx = document.getElementById('priceChart');
  if(!ctx) return;
  if(priceChartInstance) { priceChartInstance.destroy(); }
  const labels = ['Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic','Ene','Feb'];
  const data = [3200,3580,3920,4200,3800,4600,5100,5400,5800,6100,6400,6620,6842];
  priceChartInstance = new Chart(ctx, {
    type:'line',
    data:{
      labels,
      datasets:[{
        label:'Precio',
        data,
        borderColor:'#c9a96e',
        backgroundColor:'rgba(201,169,110,0.08)',
        borderWidth:2,
        pointRadius:0,
        pointHoverRadius:4,
        fill:true,
        tension:0.4
      }]
    },
    options:{
      responsive:true,maintainAspectRatio:false,
      plugins:{legend:{display:false},tooltip:{mode:'index',intersect:false,backgroundColor:'#13171f',borderColor:'#1e2530',borderWidth:1,titleColor:'#e8e4dc',bodyColor:'#7a8394'}},
      scales:{
        x:{grid:{color:'rgba(30,37,48,0.5)'},ticks:{color:'#7a8394',font:{size:11}}},
        y:{grid:{color:'rgba(30,37,48,0.5)'},ticks:{color:'#7a8394',font:{size:11},callback:v=>'$'+v.toLocaleString()}}
      }
    }
  });
}

// SIMULATOR
function switchSimTab(tab, el) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  el.classList.add('active');
  document.getElementById('sim-fixed').style.display = tab === 'fixed' ? 'block' : 'none';
  document.getElementById('sim-dynamic').style.display = tab === 'dynamic' ? 'block' : 'none';
}

function updateAlloc(slider) {
  slider.nextElementSibling.textContent = slider.value + '%';
}

function removeAlloc(btn) {
  btn.closest('.allocation-item').remove();
}

function addAsset() {
  const assets = ['PAMP','BMA','VIST','SUPV','YPF'];
  const ticker = assets[Math.floor(Math.random()*assets.length)];
  const list = document.getElementById('allocation-list');
  const item = document.createElement('div');
  item.className = 'allocation-item';
  item.innerHTML = `
    <span class="alloc-ticker">${ticker}</span>
    <input type="range" class="alloc-slider" min="0" max="100" value="20" oninput="updateAlloc(this)"/>
    <span class="alloc-pct">20%</span>
    <span class="alloc-remove" onclick="removeAlloc(this)">‚úï</span>
  `;
  list.appendChild(item);
}

function runSimulation() {
  const results = document.getElementById('sim-results');
  results.style.display = 'block';
  results.scrollIntoView({behavior:'smooth',block:'nearest'});
  setTimeout(() => {
    const ctx = document.getElementById('simChart');
    if(!ctx) return;
    if(simChartInstance) simChartInstance.destroy();
    const months = ['Ene 24','Feb','Mar','Abr','May','Jun','Jul','Ago','Sep','Oct','Nov','Dic','Ene 25','Feb 25'];
    const cartera = [100000,112000,128000,119000,145000,168000,192000,215000,248000,274000,296000,310000,318000,318240];
    const inflacion = [100000,109800,121200,134700,149600,163500,177200,188400,198000,207000,214000,220000,225000,228000];
    const mep = [100000,101200,102400,103100,104800,106200,108100,109500,111000,113200,115800,117400,119000,120300];
    simChartInstance = new Chart(ctx, {
      type:'line',
      data:{
        labels:months,
        datasets:[
          {label:'Mi cartera',data:cartera,borderColor:'#c9a96e',backgroundColor:'rgba(201,169,110,0.06)',borderWidth:2,pointRadius:0,fill:true,tension:0.4},
          {label:'Inflaci√≥n',data:inflacion,borderColor:'#e05a5a',backgroundColor:'transparent',borderWidth:1.5,borderDash:[4,4],pointRadius:0,tension:0.4},
          {label:'D√≥lar MEP',data:mep,borderColor:'#4caf82',backgroundColor:'transparent',borderWidth:1.5,borderDash:[4,4],pointRadius:0,tension:0.4},
        ]
      },
      options:{
        responsive:true,maintainAspectRatio:false,
        plugins:{legend:{display:true,labels:{color:'#7a8394',font:{size:11},boxWidth:12}},tooltip:{mode:'index',intersect:false,backgroundColor:'#13171f',borderColor:'#1e2530',borderWidth:1,titleColor:'#e8e4dc',bodyColor:'#7a8394',callbacks:{label:ctx=>' '+ctx.dataset.label+': $'+ctx.raw.toLocaleString()}}},
        scales:{
          x:{grid:{color:'rgba(30,37,48,0.5)'},ticks:{color:'#7a8394',font:{size:10}}},
          y:{grid:{color:'rgba(30,37,48,0.5)'},ticks:{color:'#7a8394',font:{size:10},callback:v=>'$'+Math.round(v/1000)+'k'}}
        }
      }
    });
  }, 100);
}

function addOp() {
  const tbody = document.getElementById('ops-body');
  const row = document.createElement('tr');
  row.innerHTML = `
    <td><select><option>Compra</option><option>Venta</option></select></td>
    <td><input type="text" placeholder="Ticker"/></td>
    <td><input type="number" placeholder="Cantidad"/></td>
    <td><input type="number" placeholder="Precio"/></td>
    <td><input type="date"/></td>
    <td><span class="remove-op" onclick="removeOp(this)">‚úï</span></td>
  `;
  tbody.appendChild(row);
}

function removeOp(btn) { btn.closest('tr').remove(); }

function runDynamic() {
  const results = document.getElementById('dyn-results');
  results.style.display = 'block';
  results.scrollIntoView({behavior:'smooth',block:'nearest'});
}

// HISTORY
function saveToHistory() {
  showToast('An√°lisis guardado en historial ‚úì', 'success');
}

// MODAL
function showUpgradeModal() {
  document.getElementById('upgradeModal').classList.add('open');
}
function closeModal() {
  document.getElementById('upgradeModal').classList.remove('open');
}
document.getElementById('upgradeModal').addEventListener('click', function(e) {
  if(e.target === this) closeModal();
});

// PDF
function exportPDF() { showToast('Generando PDF... (disponible en plan Pro)', ''); }

// TOAST
function showToast(msg, type) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.className = 'toast show ' + (type||'');
  setTimeout(() => t.className = 'toast', 3000);
}

// SIDEBAR MOBILE
function toggleSidebar() {
  document.getElementById('sidebar').classList.toggle('open');
}

// RESPONSIVE
function checkMobile() {
  const isMobile = window.innerWidth <= 768;
  document.getElementById('menu-btn').style.display = isMobile ? 'block' : 'none';
}
window.addEventListener('resize', checkMobile);
checkMobile();

// CLOSE SUGGESTIONS ON CLICK OUTSIDE
document.addEventListener('click', e => {
  if(!e.target.closest('.search-box')) {
    document.getElementById('suggestions').classList.remove('open');
  }
});
</script>
</body>
</html>
